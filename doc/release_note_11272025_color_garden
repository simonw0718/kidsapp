# Release Note â€” å½©è‰²èŠ±åœ’ (Color Garden) å®Œæ•´å¯¦ä½œ (2025-11-27)

## ç‰ˆæœ¬æ¦‚è¦½
æ­¤ç‰ˆæœ¬å¯¦ä½œäº†å…¨æ–°çš„ã€Œå½©è‰²èŠ±åœ’ã€(Color Garden) åŠŸèƒ½ï¼Œæä¾›å…’ç«¥ä¸€å€‹è‡ªç”±è‘—è‰²çš„å‰µä½œç©ºé–“ã€‚åŒ…å«å®Œæ•´çš„ç¹ªåœ–å·¥å…·ã€è‰²å½©é¸æ“‡ã€åœ–ç‰‡ç®¡ç†ã€æš«å­˜åŠŸèƒ½ï¼Œä»¥åŠé‡å° iOS è£ç½®å„ªåŒ–çš„å„²å­˜æµç¨‹ã€‚

---

## ğŸ¨ æ–°åŠŸèƒ½ (New Features)

### 1. è‡ªç”±è‘—è‰²æ¨¡å¼ (Free Coloring Mode)
- **æ ¸å¿ƒåŠŸèƒ½**ï¼šæä¾›ç©ºç™½ç•«å¸ƒä¾›å…’ç«¥è‡ªç”±ç¹ªç•«èˆ‡è‘—è‰²
- **ç¹ªåœ–å·¥å…·**ï¼š
  - **ç•«ç­† (Brush)**ï¼šå¯èª¿æ•´å¤§å° (2-80px)ï¼Œæ”¯æ´ 15 ç¨®é¡è‰²
  - **æ©¡çš®æ“¦ (Eraser)**ï¼šå¯èª¿æ•´å¤§å°ï¼Œç²¾æº–æ“¦é™¤
  - **è¦–è¦ºæ¸¸æ¨™**ï¼šé¡¯ç¤ºç•¶å‰ç•«ç­†/æ©¡çš®æ“¦å¤§å°çš„åœ“å½¢æ¸¸æ¨™
- **æ“ä½œåŠŸèƒ½**ï¼š
  - **å¾©åŸ (Undo)**ï¼šæ”¯æ´å¤šæ­¥é©Ÿå¾©åŸ
  - **æ¸…é™¤ (Clear)**ï¼šä¸€éµæ¸…ç©ºç•«å¸ƒ
  - **åœ–ç‰‡é¸æ“‡**ï¼šæä¾›å¤šå¼µé è¨­è‘—è‰²åœ–ä¾›é¸æ“‡

### 2. è‰²å½©ç³»çµ± (Color System)
- **15 è‰²èª¿è‰²ç›¤**ï¼šç²¾å¿ƒæŒ‘é¸çš„å…’ç«¥å‹å–„è‰²å½©
- **3 æ¬„å¼ä½ˆå±€**ï¼š
  - **ç¬¬ 1 æ¬„ (æš–è‰²ç³»)**ï¼šç´…ã€æ·±æ©™ã€æ©™ã€æ·ºé»ƒã€é»ƒ
  - **ç¬¬ 2 æ¬„ (å†·è‰²/è‡ªç„¶)**ï¼šèŠå§†ç¶ ã€æ·ºç¶ ã€ç¶ ã€é’ã€è—
  - **ç¬¬ 3 æ¬„ (ä¸­æ€§/å…¶ä»–)**ï¼šç´«ã€ç²‰ç´…ã€æ£•ã€ç°ã€é»‘
- **æ™ºèƒ½æ”¶åˆ**ï¼šé¸æ“‡ç•«ç­†/æ©¡çš®æ“¦æ™‚è‡ªå‹•éš±è—èª¿è‰²ç›¤

### 3. iOS å„ªåŒ–å„²å­˜æµç¨‹ (iOS-Optimized Save Flow)
- **å•é¡Œ**ï¼šiOS è£ç½®ä¸Šç›´æ¥ä¸‹è¼‰æœƒå°è‡´ App é‡æ–°è¼‰å…¥æˆ–é»‘å±
- **è§£æ±ºæ–¹æ¡ˆ**ï¼š
  - **å„ªå…ˆä½¿ç”¨åŸç”Ÿåˆ†äº«**ï¼šåœ¨ HTTPS/localhost ç’°å¢ƒä¸‹ä½¿ç”¨ `navigator.share` API
  - **iOS å°ˆå±¬é è¦½æ¨¡å¼**ï¼š
    - é¡¯ç¤ºã€Œé•·æŒ‰åœ–ç‰‡å„²å­˜ã€æŒ‡ç¤º
    - éš±è—ä¸‹è¼‰æŒ‰éˆ•ä»¥é¿å… App é‡è¼‰
  - **æ¡Œé¢/Android æ¨¡å¼**ï¼šæä¾›ä¸‹è¼‰æŒ‰éˆ•ä¾›å¿«é€Ÿå„²å­˜
- **çµæœ**ï¼šå®Œå…¨é¿å… iOS ä¸Šçš„é»‘å±èˆ‡ App é‡è¼‰å•é¡Œ

### 4. æš«å­˜ä½œå“åŠŸèƒ½ (Temporary Save Slots)
- **åŠŸèƒ½æè¿°**ï¼šå…è¨±ä½¿ç”¨è€…æš«å­˜ç•¶å‰ä½œå“ï¼Œç¨å¾Œç¹¼çºŒå‰µä½œ
- **2 å€‹æš«å­˜æ§½ä½**ï¼š
  - é¡¯ç¤ºé è¦½åœ–èˆ‡å„²å­˜æ™‚é–“
  - æ”¯æ´å„²å­˜ã€è®€å–ã€è¦†è“‹ã€åˆªé™¤æ“ä½œ
- **å®Œæ•´ç‹€æ…‹ä¿å­˜**ï¼š
  - ç•«å¸ƒå…§å®¹ (ImageData)
  - èƒŒæ™¯åœ–ç‰‡ ID
  - ç•«ç­†è¨­å®š (é¡è‰²ã€å¤§å°ã€å·¥å…·)
- **æœ¬åœ°å„²å­˜**ï¼šä½¿ç”¨ IndexedDB å„²å­˜å¤§å‹åœ–ç‰‡è³‡æ–™
- **æ“ä½œæŒ‰éˆ•**ï¼š
  - **å„²å­˜ (Save)**ï¼šå„²å­˜ç•¶å‰ä½œå“åˆ°ç©ºæ§½ä½
  - **è¦†è“‹ (Overwrite)**ï¼šè¦†è“‹ç¾æœ‰æ§½ä½
  - **è®€å– (Load)**ï¼šè¼‰å…¥å·²å„²å­˜çš„ä½œå“
  - **åˆªé™¤ (Delete)**ï¼šåˆªé™¤å·²å„²å­˜çš„ä½œå“

### 5. éŸ¿æ‡‰å¼ç•«å¸ƒç³»çµ± (Responsive Canvas System)
- **å•é¡Œ**ï¼šç•«ç­†ä½ç½®åç§»ï¼Œéœ€é‡å•Ÿ App æ‰èƒ½ä¿®æ­£
- **è§£æ±ºæ–¹æ¡ˆ**ï¼š
  - å¯¦ä½œ `ResizeObserver` ç›£è½ç•«å¸ƒå°ºå¯¸è®ŠåŒ–
  - è‡ªå‹•èª¿æ•´ç•«å¸ƒå…§éƒ¨è§£æåº¦ä»¥åŒ¹é…é¡¯ç¤ºå°ºå¯¸
  - ä¿ç•™ç¾æœ‰ç¹ªåœ–å…§å®¹ï¼Œç„¡éœ€é‡ç¹ª
- **çµæœ**ï¼šå®Œå…¨æ¶ˆé™¤åº§æ¨™åç§»å•é¡Œï¼Œæ”¯æ´è¢å¹•æ—‹è½‰èˆ‡è¦–çª—èª¿æ•´

---

## ğŸ› ï¸ æŠ€è¡“å¯¦ä½œ (Technical Implementation)

### æ–°å¢æª”æ¡ˆ
```
src/features/color-garden/
â”œâ”€â”€ ColorGardenGame.tsx              # ä¸»éŠæˆ²å…ƒä»¶
â”œâ”€â”€ color-garden.css                 # æ¨£å¼è¡¨
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ColoringCanvas.tsx           # ç•«å¸ƒå…ƒä»¶ (æ”¯æ´è§¸æ§èˆ‡æ»‘é¼ )
â”‚   â”œâ”€â”€ ImageSelector.tsx            # åœ–ç‰‡é¸æ“‡å™¨
â”‚   â””â”€â”€ SaveSlotsModal.tsx           # æš«å­˜æ§½ä½ç®¡ç†ä»‹é¢
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useCanvas.ts                 # ç•«å¸ƒé‚è¼¯ Hook
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ storage.ts                   # IndexedDB å„²å­˜å·¥å…·
â””â”€â”€ config/
    â””â”€â”€ images.ts                    # åœ–ç‰‡è³‡æºé…ç½®
```

### æ ¸å¿ƒæŠ€è¡“
- **Canvas API**ï¼šé«˜æ•ˆèƒ½ç¹ªåœ–èˆ‡åƒç´ æ“ä½œ
- **ResizeObserver**ï¼šè‡ªå‹•åµæ¸¬ç•«å¸ƒå°ºå¯¸è®ŠåŒ–
- **IndexedDB**ï¼šå¤§å®¹é‡æœ¬åœ°è³‡æ–™å„²å­˜
- **Web Share API**ï¼šåŸç”Ÿåˆ†äº«åŠŸèƒ½ (iOS/Android)
- **Touch Events**ï¼šå®Œæ•´è§¸æ§æ”¯æ´
- **React Hooks**ï¼šç‹€æ…‹ç®¡ç†èˆ‡å‰¯ä½œç”¨è™•ç†

### é—œéµåŠŸèƒ½å¯¦ä½œ
1. **ç¹ªåœ–å¼•æ“**ï¼š
   - ä½¿ç”¨ `CanvasRenderingContext2D` é€²è¡Œå³æ™‚ç¹ªè£½
   - æ”¯æ´å¹³æ»‘ç·šæ¢ (`lineCap: 'round'`, `lineJoin: 'round'`)
   - æ©¡çš®æ“¦ä½¿ç”¨ `globalCompositeOperation = 'destination-out'`

2. **å¾©åŸç³»çµ±**ï¼š
   - ä½¿ç”¨ `ImageData` é™£åˆ—å„²å­˜æ­·å²ç‹€æ…‹
   - é™åˆ¶æœ€å¤š 20 æ­¥å¾©åŸä»¥ç¯€çœè¨˜æ†¶é«”

3. **æš«å­˜ç³»çµ±**ï¼š
   - å°‡ `ImageData` åºåˆ—åŒ–å¾Œå­˜å…¥ IndexedDB
   - ç”Ÿæˆå£“ç¸®é è¦½åœ– (PNG, 50% å“è³ª)
   - æ”¯æ´è¦†è“‹èˆ‡åˆªé™¤æ“ä½œ

---

## ğŸ¯ ä½¿ç”¨è€…ä»‹é¢ (User Interface)

### å·¥å…·åˆ—ä½ˆå±€ (ç”±ä¸Šè‡³ä¸‹)
1. **é¸æ“‡åœ–ç´™** + **å„²å­˜åœ–ç‰‡** (ä¸¦æ’)
2. **ç•«ç­†** (é¡¯ç¤ºç•¶å‰é¡è‰²æŒ‡ç¤ºå™¨)
3. **èª¿è‰²ç›¤** (3x5 è‰²å½©ç¶²æ ¼)
4. **æ©¡çš®æ“¦**
5. **æš«å­˜ä½œå“** (æ›¸ç±¤åœ–ç¤º)
6. **å¾©åŸ** + **æ¸…é™¤** (ä¸¦æ’)

### äº’å‹•è¨­è¨ˆ
- **å½ˆå‡ºå¼æ»‘æ¡¿**ï¼šé»æ“Šç•«ç­†/æ©¡çš®æ“¦é¡¯ç¤ºå‚ç›´æ»‘æ¡¿èª¿æ•´å¤§å°
- **è‡ªå‹•æ”¶åˆ**ï¼šé¸æ“‡å·¥å…·æ™‚è‡ªå‹•éš±è—å…¶ä»–å½ˆå‡ºè¦–çª—
- **ç¢ºèªå°è©±æ¡†**ï¼šæ¸…é™¤ã€å„²å­˜ã€è®€å–ç­‰æ“ä½œçš†æœ‰ç¢ºèªæç¤º
- **è¼‰å…¥ç‹€æ…‹**ï¼šæš«å­˜æ“ä½œæ™‚ç¦ç”¨æŒ‰éˆ•ä¸¦é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹

---

## ğŸ› å·²çŸ¥å•é¡Œèˆ‡ä¿®æ­£ (Known Issues & Fixes)

### å·²ä¿®æ­£
1. âœ… **ç•«ç­†åç§»å•é¡Œ**ï¼šé€é ResizeObserver å®Œå…¨è§£æ±º
2. âœ… **iOS å„²å­˜é»‘å±**ï¼šæ”¹ç”¨é•·æŒ‰å„²å­˜æŒ‡ç¤ºï¼Œé¿å…ç›´æ¥ä¸‹è¼‰
3. âœ… **èª¿è‰²ç›¤ä½ˆå±€**ï¼šå¾ 2 æ¬„æ”¹ç‚º 3 æ¬„ï¼Œæ›´ç¬¦åˆè‰²å½©åˆ†é¡

### å¾…é©—è­‰
1. âš ï¸ **æš«å­˜åŠŸèƒ½**ï¼šå„²å­˜æ“ä½œå¯èƒ½æœªæ­£ç¢ºåŸ·è¡Œï¼Œéœ€é€²ä¸€æ­¥æ¸¬è©¦
   - å·²æ–°å¢è©³ç´° console.log ä»¥å”åŠ©é™¤éŒ¯
   - å·²å¯¦ä½œéŒ¯èª¤è™•ç†èˆ‡ä½¿ç”¨è€…æç¤º

---

## ğŸ“¦ ä¿®æ”¹æª”æ¡ˆæ¸…å–®

### æ–°å¢æª”æ¡ˆ
- `src/features/color-garden/ColorGardenGame.tsx`
- `src/features/color-garden/color-garden.css`
- `src/features/color-garden/components/ColoringCanvas.tsx`
- `src/features/color-garden/components/ImageSelector.tsx`
- `src/features/color-garden/components/SaveSlotsModal.tsx`
- `src/features/color-garden/hooks/useCanvas.ts`
- `src/features/color-garden/utils/storage.ts`
- `src/features/color-garden/config/images.ts`
- `public/assets/images/color-garden/tool-*.png` (å·¥å…·åœ–ç¤º)

### ä¿®æ”¹æª”æ¡ˆ
- `src/pages/ColorGardenPage.tsx` (æ•´åˆæ–°åŠŸèƒ½)
- `src/App.tsx` (è·¯ç”±è¨­å®š)

---

## ğŸ“ æ¸¬è©¦å»ºè­°

### åŸºæœ¬åŠŸèƒ½æ¸¬è©¦
1. **ç¹ªåœ–æ¸¬è©¦**ï¼š
   - ä½¿ç”¨ä¸åŒé¡è‰²èˆ‡ç•«ç­†å¤§å°ç¹ªè£½
   - æ¸¬è©¦æ©¡çš®æ“¦åŠŸèƒ½
   - é©—è­‰å¾©åŸåŠŸèƒ½
   - æ¸¬è©¦æ¸…é™¤åŠŸèƒ½

2. **å„²å­˜æ¸¬è©¦**ï¼š
   - **iOS è£ç½®**ï¼šé©—è­‰é•·æŒ‰å„²å­˜æµç¨‹
   - **æ¡Œé¢/Android**ï¼šæ¸¬è©¦ä¸‹è¼‰æŒ‰éˆ•
   - ç¢ºèªå„²å­˜çš„åœ–ç‰‡åŒ…å«èƒŒæ™¯èˆ‡ç¹ªåœ–

3. **æš«å­˜æ¸¬è©¦** (éœ€é€²ä¸€æ­¥é©—è­‰)ï¼š
   - ç¹ªè£½å…§å®¹ä¸¦å„²å­˜åˆ°æ§½ä½ 1
   - é–‹å•Ÿç€è¦½å™¨ Console æª¢æŸ¥ log
   - å˜—è©¦è®€å–ã€è¦†è“‹ã€åˆªé™¤æ“ä½œ

### ç›¸å®¹æ€§æ¸¬è©¦
- **iOS Safari** (iPhone/iPad)
- **Android Chrome**
- **Desktop Chrome/Safari/Firefox**
- **ä¸åŒè¢å¹•å°ºå¯¸èˆ‡æ–¹å‘**

---

## ğŸ“ è¨­è¨ˆç†å¿µ

### å…’ç«¥å‹å–„è¨­è¨ˆ
- **å¤§å‹æŒ‰éˆ•**ï¼šæ˜“æ–¼è§¸æ§æ“ä½œ
- **è¦–è¦ºå›é¥‹**ï¼šæ¸¸æ¨™ã€é«˜äº®ã€å‹•ç•«æ•ˆæœ
- **ç°¡åŒ–æµç¨‹**ï¼šæœ€å°‘æ­¥é©Ÿå®Œæˆæ“ä½œ
- **éŒ¯èª¤å®¹å¿**ï¼šæ”¯æ´å¾©åŸèˆ‡æ¸…é™¤

### æ•ˆèƒ½å„ªåŒ–
- **Canvas ç¡¬é«”åŠ é€Ÿ**ï¼šæµæš¢ç¹ªåœ–é«”é©—
- **è¨˜æ†¶é«”ç®¡ç†**ï¼šé™åˆ¶å¾©åŸæ­¥æ•¸ï¼Œé¿å…è¨˜æ†¶é«”æº¢å‡º
- **åœ–ç‰‡å£“ç¸®**ï¼šé è¦½åœ–ä½¿ç”¨ 50% å“è³ªæ¸›å°‘å„²å­˜ç©ºé–“

### è·¨å¹³å°ç›¸å®¹
- **è§¸æ§å„ªå…ˆ**ï¼šå®Œæ•´æ”¯æ´è§¸æ§æ‰‹å‹¢
- **æ»‘é¼ æ”¯æ´**ï¼šæ¡Œé¢ç’°å¢ƒåŒæ¨£æµæš¢
- **iOS ç‰¹æ®Šè™•ç†**ï¼šé‡å° iOS é™åˆ¶æä¾›æ›¿ä»£æ–¹æ¡ˆ

---

## ğŸ“… æœªä¾†æ”¹é€²æ–¹å‘

1. **æ›´å¤šè‘—è‰²åœ–**ï¼šæ“´å……åœ–ç‰‡åº«
2. **è‡ªè¨‚é¡è‰²**ï¼šæ”¯æ´è‰²å½©é¸æ“‡å™¨
3. **åœ–å±¤ç³»çµ±**ï¼šæ”¯æ´å¤šåœ–å±¤ç·¨è¼¯
4. **åŒ¯å‡ºæ ¼å¼**ï¼šæ”¯æ´ SVGã€PDF ç­‰æ ¼å¼
5. **é›²ç«¯åŒæ­¥**ï¼šè·¨è£ç½®åŒæ­¥ä½œå“
6. **ç¤¾ç¾¤åˆ†äº«**ï¼šåˆ†äº«ä½œå“åˆ°ç¤¾ç¾¤å¹³å°

---

## ğŸ‘¨â€ğŸ’» é–‹ç™¼è€…å‚™è¨»

### IndexedDB é™¤éŒ¯
è‹¥æš«å­˜åŠŸèƒ½ç•°å¸¸ï¼Œè«‹æª¢æŸ¥ï¼š
1. ç€è¦½å™¨ Console ä¸­çš„ log è¨Šæ¯
2. Application > IndexedDB > ColorGardenDB
3. ç¢ºèª `window.isSecureContext` ç‚º `true` (éœ€ HTTPS æˆ– localhost)

### ç•«å¸ƒåº§æ¨™ç³»çµ±
- å…§éƒ¨è§£æåº¦ = é¡¯ç¤ºå°ºå¯¸ (é€é ResizeObserver åŒæ­¥)
- è§¸æ§åº§æ¨™éœ€è½‰æ›ï¼š`getBoundingClientRect()` è¨ˆç®—åç§»

### CSS è®Šæ•¸
å¯èª¿æ•´çš„ CSS è®Šæ•¸ä½æ–¼ `color-garden.css`ï¼š
- `--cg-toolbar-width`: å·¥å…·åˆ—å¯¬åº¦
- `--cg-tool-btn-size`: å·¥å…·æŒ‰éˆ•å¤§å°
- `--cg-palette-size`: èª¿è‰²ç›¤è‰²å¡Šå¤§å°

---

**ç‰ˆæœ¬**ï¼šv1.0  
**ç™¼å¸ƒæ—¥æœŸ**ï¼š2025-11-27  
**é–‹ç™¼è€…**ï¼šAntigravity AI Assistant
