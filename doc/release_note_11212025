# Release Note — 圖片配對翻牌動畫 + 恐龍詞庫更新 (2025-11-21)

## 版本概覽
此版本為「圖片配對遊戲」新增了卡片翻牌動畫功能（英文模式專用），實作智慧字體大小調整與自動分行顯示，並更新恐龍詞庫內容。同時完善了格式調整指南文檔。

---

## 🎮 新功能（Features）

### 1. 卡片翻牌動畫（Card Flip Animation）

#### 英文模式專用功能
- **觸發時機**：英文模式答對時，正確答案卡片自動翻轉
- **翻牌內容**：
  - 正面：英文單字圖片/Emoji
  - 背面：中文字 + 注音符號（使用 `ZhuyinWord` 組件）
  
- **動畫效果**：
  - 3D 翻轉動畫：`rotateY(180deg)`
  - 翻轉速度：`0.6s`（可調整）
  - 背面背景色：淡黃色 `#FFF9E6`
  - 翻轉後卡片自動提升至最上層（`z-index: 10`），防止被遮擋

#### 實作細節
- **檔案**：`src/features/picture-match/components/ImageCard.tsx`
- **技術**：
  - 使用 `transform-style: preserve-3d` 實現 3D 效果
  - 使用 `backface-visibility: hidden` 隱藏背面
  - 前後兩面使用絕對定位重疊
  - 透過 `showFlipped` prop 控制翻轉狀態

### 2. 智慧字體大小調整（Dynamic Font Sizing）

#### 自動判斷中文字數
- **規則**：
  - **1-2 個字**：使用 `3rem` 大字體（例如：魚龍、冠龍）
  - **3 個字以上**：使用 `1.5rem` 小字體（例如：南方巨獸龍）
  
- **實作邏輯**：
  - 新增 `getFlipFontSize()` 函數
  - 只計算中文字數（`item.chinese.length`），不包含注音
  - 自動套用，無需手動設定

### 3. 自動分行顯示（Automatic Line Breaking）

#### 長詞語分兩行
- **規則**：
  - **1-3 個字**：單行顯示
  - **4 個字以上**：自動分成兩行
  
- **分行邏輯**：
  - 使用 `Math.ceil(maxLength / 2)` 計算每行字數
  - 盡量平均分配（例如：5 個字 → 3字/2字）
  - 垂直排列，行間距 `12px`
  
- **實作細節**：
  - **檔案**：`src/features/picture-match/components/ZhuyinWord.tsx`
  - 新增 `renderRow()` 函數處理每一行
  - 使用 `flexDirection: 'column'` 垂直排列
  - 每行獨立渲染，保持注音與中文對應

---

## 📚 詞庫更新

### 恐龍詞庫更新（Dinosaur Vocabulary）

#### 新增 3 個恐龍
- **Protoceratops** (原角龍) - ㄩㄢˊ ㄐㄧㄠˇ ㄌㄨㄥˊ
- **Therizinosaurus** (鐮刀龍) - ㄌㄧㄢˊ ㄉㄠ ㄌㄨㄥˊ
- **Microraptor** (小盜龍) - ㄒㄧㄠˇ ㄉㄠˋ ㄌㄨㄥˊ

#### 移除 3 個恐龍
- Spinosaurus (棘龍)
- Pachycephalosaurus (厚頭龍)
- Mosasaurus (滄龍)

#### 保留 6 個恐龍
- Compsognathus (美頜龍)
- Mamenchisaurus (馬門溪龍)
- Giganotosaurus (南方巨獸龍)
- Ichthyosaurus (魚龍)
- Corythosaurus (冠龍)
- Oviraptor (偷蛋龍)

#### 注音修正
- **Brachiosaurus** (腕龍)：`ㄨㄢˋ` → `ㄨㄢˇ`
- **Corythosaurus** (冠龍)：`ㄍㄨㄢ` → `ㄍㄨㄢˋ`

---

## 🎨 UI/UX 調整

### 1. 翻牌卡片視覺優化

#### 背面設計
- **背景色**：淡黃色 `#FFF9E6`，與正面白色區分
- **圓角**：`24px`，與正面一致
- **內距**：`16px`，確保文字不貼邊
- **字間距**：`20px`，清晰易讀
- **行間距**：`12px`（多行時），層次分明

#### 層級管理
- **翻轉後**：`z-index: 10`，顯示在最上層
- **一般狀態**：`z-index: 1`，正常層級
- **目的**：防止翻牌後的文字被其他卡片遮擋

### 2. 響應式字體

#### 自適應設計
- 短詞使用大字體，提升可讀性
- 長詞使用小字體並分行，避免溢出
- 所有調整自動進行，確保一致性

---

## 📝 文件更新

### FormatAdjustmentGuide.md 更新

#### 新增章節：翻牌動畫設定
- **1.2 節**：`components/ImageCard.tsx` 翻牌動畫參數
  - 翻牌速度調整
  - 背面背景色設定
  - 字體大小自動調整說明
  
- **1.3 節**：`components/ZhuyinWord.tsx` 顯示設定
  - 字與字之間的間距
  - 對齊方式設定
  
- **1.4 節**：注音符號樣式 (BpmWord)
  - 國字大小設定
  - 注音符號大小設定
  - 聲調符號顏色、大小、位置
  - 輕聲符號設定

#### 更新內容
- 所有參數都加上中文註解
- 明確標註 `[調整]` 可修改的參數
- 提供具體的調整範例與建議值

---

## 🔧 技術改善

### 1. 組件化設計

#### ImageCard 組件增強
- 新增 `getFlipFontSize()` 函數處理動態字體
- 新增 `showFlipped` prop 控制翻轉狀態
- 整合 3D 翻轉動畫邏輯
- 保持向後兼容，不影響其他模式

#### ZhuyinWord 組件重構
- 新增 `renderRow()` 函數處理分行邏輯
- 支援單行與雙行自動切換
- 保持字與注音的正確對應
- 使用 `flexDirection: 'column'` 實現垂直排列

### 2. 性能優化

#### 條件渲染
- 只在需要時渲染第二行
- 使用 `shouldSplitRows` 判斷是否分行
- 避免不必要的 DOM 元素

#### CSS 優化
- 使用 `backface-visibility: hidden` 提升動畫性能
- 使用 `transform` 而非 `left/top` 實現動畫
- 硬體加速的 3D 變換

---

## 📦 修改檔案清單

### 核心功能檔案
- `src/features/picture-match/components/ImageCard.tsx` - 新增翻牌動畫、動態字體大小
- `src/features/picture-match/components/ZhuyinWord.tsx` - 新增自動分行邏輯
- `src/features/picture-match/PictureMatchGame.tsx` - 傳遞 `showFlipped` prop

### 樣式檔案
- `src/features/picture-match/picture-match.css` - 新增翻牌動畫 CSS
- `src/core/layout/layout.css` - 注音符號樣式（已有中文註解）

### 資料檔案
- `src/features/picture-match/data/vocab.ts` - 更新恐龍詞庫、修正注音

### 文件
- `doc/FormatAdjustmentGuide.md` - 新增翻牌動畫與注音符號樣式說明

---

## 🎯 調整建議

### 翻牌動畫調整
- **檔案**：`src/features/picture-match/components/ImageCard.tsx`
- **翻牌速度**：修改 `transition` 中的 `transform 0.6s`（數值越大越慢）
- **背面背景色**：修改第 109 行的 `backgroundColor: '#FFF9E6'`
- **字體大小規則**：修改 `getFlipFontSize()` 函數中的 `3rem` 和 `1.5rem`

### 注音符號調整
- **檔案**：`src/core/layout/layout.css`（第 261-319 行）
- **國字大小**：修改 `.bpm-main-char` 的 `font-size`（目前 `1em`）
- **注音大小**：修改 `.bpm-column` 的 `font-size`（目前 `0.45em`）
- **聲調顏色**：修改 `.bpm-tone` 的 `color`（目前 `#d32f2f` 紅色）
- **聲調大小**：修改 `.bpm-tone` 的 `font-size`（目前 `1.3em`）

### 分行邏輯調整
- **檔案**：`src/features/picture-match/components/ZhuyinWord.tsx`
- **分行門檻**：修改第 22 行的 `maxLength > 3`（改為 `> 4` 則 5 字以上才分行）
- **字間距**：修改第 29 行的 `gap: '20px'`
- **行間距**：修改第 54 行的 `gap: '12px'`

---

## 📊 統計資訊

- **修改檔案數**：7 個
- **新增功能**：3 個（翻牌動畫、動態字體、自動分行）
- **新增程式碼行數**：約 80 行
- **詞庫更新**：新增 3 個恐龍、移除 3 個恐龍、修正 2 個注音
- **文件更新**：FormatAdjustmentGuide.md 新增 3 個小節

---

## 🔄 與前一版本的差異

### 前一版本（11-20）
- 動物指令大冒險 CSS 架構重構
- 桌面版佈局優化
- 遊戲專屬縮放鎖定

### 本版本（11-21）
- **圖片配對翻牌動畫**（全新功能）
- **智慧字體大小調整**（自動判斷）
- **自動分行顯示**（長詞優化）
- **恐龍詞庫更新**（內容更新）
- **文檔完善**（新增翻牌相關說明）

---

## 💡 使用說明

### 翻牌動畫使用方式
1. 選擇「英文模式」
2. 答對題目後，正確答案卡片會自動翻轉
3. 背面顯示中文字和注音符號
4. 短詞（1-2字）顯示大字體單行
5. 長詞（3字以上）顯示小字體，4字以上自動分兩行

### 調整字體大小
- 開啟 `ImageCard.tsx`
- 找到 `getFlipFontSize()` 函數（第 26-33 行）
- 修改 `'3rem'` 或 `'1.5rem'` 為想要的大小
- 儲存後重新整理頁面即可看到效果

---

本次更新為圖片配對遊戲帶來了全新的互動體驗，翻牌動畫讓學習過程更加生動有趣。智慧字體調整與自動分行功能確保了各種長度的詞語都能清晰顯示，提升了整體的使用體驗。
